Проблема: Ускорение получения остатков для большого количества номенклатуры.
____________________________________________________________________________

// Вместо получения остатков по одной позиции:
Функция ПолучитьОстаткиМассивом(МассивНоменклатуры, Склад, Дата)
    Запрос = Новый Запрос;
    Запрос.Текст = 
        "ВЫБРАТЬ
        |   ОстаткиТоваров.Номенклатура,
        |   СУММА(ОстаткиТоваров.Количество) КАК Количество
        |ИЗ
        |   РегистрНакопления.ОстаткиТоваров КАК ОстаткиТоваров
        |ГДЕ
        |   ОстаткиТоваров.Номенклатура В(&МассивНоменклатуры)
        |   И ОстаткиТоваров.Склад = &Склад
        |   И ОстаткиТоваров.Дата <= &Дата
        |СГРУППИРОВАТЬ ПО
        |   ОстаткиТоваров.Номенклатура";
    
    Запрос.УстановитьПараметр("МассивНоменклатуры", МассивНоменклатуры);
    Запрос.УстановитьПараметр("Склад", Склад);
    Запрос.УстановитьПараметр("Дата", Дата);
    
    Результат = Запрос.Выполнить().Выгрузить();
    Возврат Результат.Свернуть("Номенклатура", "Количество");
КонецФункции
